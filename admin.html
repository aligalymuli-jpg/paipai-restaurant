<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Админка | Pai Pai</title>
    <link rel="stylesheet" href="style.css">
    <style>
        #admin-content {
            display: none;
        }
        
        .login-screen {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #0a0a0a;
            position: fixed;
            width: 100%;
            z-index: 2000;
        }
        
        .admin-box {
            max-width: 500px;
            width: 90%;
            background: #111;
            padding: 25px;
            border-radius: 20px;
            border: 1px solid #c48c5d;
            text-align: center;
        }
        
        input,
        select {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: #222;
            color: white;
            border: 1px solid #444;
            border-radius: 10px;
            font-family: inherit;
        }
        
        .item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #333;
            color: white;
            text-align: left;
        }
    </style>
</head>

<body>
    <div id="login-form" class="login-screen">
        <div class="admin-box">
            <h2 style="color: #c48c5d; margin-bottom: 20px;">Вход для администратора</h2>
            <input type="password" id="admin-pass-input" placeholder="Введите пароль доступа">
            <button onclick="checkAccess()" class="btn-primary" style="width: 100%; margin-top: 10px; cursor: pointer;">Войти</button>
            <p id="error-msg" style="color: #ff4d4d; margin-top: 15px; display: none;">Неверный пароль!</p>
        </div>
    </div>

    <div id="admin-content">
        <div class="admin-box" style="margin: 20px auto; text-align: left;">
            <a href="index.html" style="color:#c48c5d; text-decoration: none;">← Вернуться на сайт</a>
            <h2 style="margin: 20px 0">Добавить блюдо</h2>
            <input type="text" id="name" placeholder="Название блюда">
            <input type="number" id="price" placeholder="Цена (₸)">
            <input type="text" id="img" placeholder="Ссылка на фото (URL)">
            <select id="cat">
                <option value="first">Первые блюда</option>
                <option value="second">Вторые блюда</option>
                <option value="salad">Салаты</option>
                <option value="company">На компанию</option>
                <option value="bakery">Выпечка</option>
                <option value="dessert">Десерты</option>
                <option value="coffee">Кофе / Напитки</option>
            </select>
            <button onclick="upload()" class="btn-primary" style="width:100%; margin-top: 10px; cursor: pointer;">Опубликовать</button>

            <h3 style="margin-top: 30px; color: #c48c5d;">Управление меню:</h3>
            <div id="list"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDU7Q6LOha4gIBz6HoHyx3Nx7LwWi4dSls",
            authDomain: "ali1-717e6.firebaseapp.com",
            databaseURL: "https://ali1-717e6-default-rtdb.firebaseio.com",
            projectId: "ali1-717e6",
            storageBucket: "ali1-717e6.firebasestorage.app",
            messagingSenderId: "293002535182",
            appId: "1:293002535182:web:ac9be8c8ab5610e2e8375f"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        function checkAccess() {
            const entered = document.getElementById('admin-pass-input').value;
            database.ref('admin_settings/pass').once('value').then(s => {
                if (entered === s.val()) {
                    document.getElementById('login-form').style.display = 'none';
                    document.getElementById('admin-content').style.display = 'block';
                    loadList();
                } else {
                    document.getElementById('error-msg').style.display = 'block';
                }
            });
        }

        function upload() {
            const name = document.getElementById('name').value;
            const price = document.getElementById('price').value;
            const img = document.getElementById('img').value;
            const cat = document.getElementById('cat').value;

            if (name && price && img) {
                database.ref('products').push({
                    name,
                    price: parseInt(price),
                    img,
                    cat
                }).then(() => {
                    alert("Блюдо добавлено!");
                    document.getElementById('name').value = '';
                    document.getElementById('price').value = '';
                    document.getElementById('img').value = '';
                });
            } else {
                alert("Заполните все поля!");
            }
        }

        function loadList() {
            database.ref('products').on('value', s => {
                const list = document.getElementById('list');
                const data = s.val();
                list.innerHTML = '';
                if (!data) return;
                for (let id in data) {
                    list.innerHTML += `
                        <div class="item-row">
                            <span>${data[id].name}</span>
                            <button onclick="database.ref('products/${id}').remove()" style="color:#ff4d4d; background:none; border:none; cursor:pointer; font-weight:bold;">Удалить</button>
                        </div>`;
                }
            });
        }
    </script>
</body>

</html>